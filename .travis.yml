sudo: required

services:
  - docker

env:
  DOCKER_COMPOSE_VERSION: 1.21.1

before_install:
  - sudo rm /usr/local/bin/docker-compose
  - curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` > docker-compose
  - chmod +x docker-compose
  - sudo mv docker-compose /usr/local/bin

before_script:
  - export REACT_APP_SERPENT_SERVICE_URL=http://127.0.0.1
  - docker-compose -f docker-compose-dev.yml up --build -d

script:
  - docker-compose -f docker-compose-dev.yml run serpentapi python manage.py test
  - docker-compose -f docker-compose-dev.yml run serpentapi flake8 project

after_script:
  - docker-compose -f docker-compose-dev.yml down
 
notifications:
  slack:
    secure: V1eqAJeDUMd8rCHxcclAta8dn1lO0Mms4UwYt9+Fwqu4AMTPTlFBYOEz9s1PC8aZ9jIpUdfjyo54dXsX9fShoNuzyJ1IiyCdXZekFHMfPG7xfNfnHlqoPYbRUHC/WzWtKtLccS+gaBg8huGg/sshG0XpRoBWCDoD9W71r0QkMKMdpQLgv4eAoXeBsJtVlOZPg4aUsLeAzDU1GTKBveY71EOoUi0SkKY81U9fiZeuRFr9Hb91V7/cX+8H5wiqlLDHtlJBcdAdoF9l7HVc8sMeoWYv7lGKN4mcIlwKbcIvAgU2dsvpZZpA7ibv76c6nls5zIsb1QnqAZ1fDYKmTcH4nMr73vDCV75nGHM+ihlsnQHLhxuQAYKFj+QnegIeBzwI7xtmt046vvlPFQ6G+qI5pWU254n9bGwVrG8pl8IX7sfKkL6S+/Ndf2yGLBgkmkocyWepiEvzKsye2o74NJEJc3X1MDM35pOe1u0FtLbmWPQ+rq3Tm87qYGI2oj5NzhEs756AGbR9Jadh52PPCqJxTbtpuUHPODpXe41pqpOBPquPQR/oIl92Y6Oy/CC0MUCh6oOf1JiBQx35v+ypnB8+nH7lTGg/UDYkXGlmogRFHzFd+qhEzlUiRZEfDErZtio9bOKusLokmh9INnyLd5VjAtzG4ilftBm+j+6Tp8wxtig=
